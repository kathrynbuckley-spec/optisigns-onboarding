<div class="onboarding-container">
  <!-- Header with Logo and Progress -->
  <div class="header">
    <div class="logo-section">
      <div class="logo-icon">
        <img src="assets/optisigns-logo.png" alt="OptiSigns Logo">
      </div>
      <div class="logo-text">
        <h1>OptiSigns</h1>
        <p>Welcome! Let's get you set up</p>
      </div>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-bar-container">
      <div class="progress-bar-track">
        <div class="progress-bar-fill" [style.width.%]="progress"></div>
      </div>
      <div class="progress-text">
        <span class="step-label">Step {{ currentStep }} of {{ totalSteps }}</span>
        <span class="progress-percentage">{{ progress | number:'1.0-0' }}%</span>
      </div>
    </div>
  </div>

  <!-- Main Content: Split Screen Layout -->
  <div class="content-wrapper">
    <div class="content-left">
      <form [formGroup]="questionnaireForm">

        <!-- Step 1: Country + Company Name + Company Size -->
        <div class="step-content" *ngIf="currentStep === 1">
          <h2>Tell us about your company</h2>
          <p class="subtitle">We'll customize your experience based on your information</p>

          <div class="company-info">
            <!-- Country Selection -->
            <div class="form-field">
              <label>Country</label>
              <select formControlName="accountCountry" class="form-select">
                <option value="">Select a country...</option>
                <optgroup label="Popular Countries">
                  <option *ngFor="let country of topCountries" [value]="country">{{ country }}</option>
                </optgroup>
                <optgroup label="All Countries">
                  <option *ngFor="let country of allCountries" [value]="country">{{ country }}</option>
                </optgroup>
              </select>
            </div>

            <!-- Company Name -->
            <div class="form-field">
              <label for="companyName">Company Name</label>
              <input
                type="text"
                id="companyName"
                formControlName="companyName"
                class="form-input"
                placeholder="Enter your company name"
              />
            </div>

            <!-- Company Size -->
            <div class="form-field">
              <label>Company Size</label>
              <select formControlName="companySize" class="form-select">
                <option value="">Select company size...</option>
                <option *ngFor="let size of companySizes" [value]="size">{{ size }} employees</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Step 2: Industry Selection -->
        <div class="step-content" *ngIf="currentStep === 2">
          <h2>What are you planning on using OptiSigns for?</h2>
          <p class="subtitle">This helps us tailor your experience</p>

          <div class="industry-grid">
            <div
              *ngFor="let industry of industries"
              class="industry-card"
              [class.selected]="questionnaireForm.get('industry')?.value === industry.value"
              (click)="questionnaireForm.patchValue({ industry: industry.value })"
            >
              <div class="industry-icon">{{ industry.icon }}</div>
              <div class="industry-label">{{ industry.label }}</div>
            </div>
          </div>
        </div>

        <!-- Step 3: Screen Count + Primary Use Case -->
        <div class="step-content" *ngIf="currentStep === 3">
          <h2>Tell us about your setup</h2>
          <p class="subtitle">Help us understand your deployment</p>

          <div class="company-info">
            <!-- Number of Screens Dropdown -->
            <div class="form-field">
              <label>How many screens do you plan on using?</label>
              <select formControlName="numberOfScreens" class="form-select">
                <option value="">Select screen count...</option>
                <option *ngFor="let screen of screenCounts" [value]="screen.value">
                  {{ screen.label }} - {{ screen.description }}
                </option>
              </select>
            </div>
          </div>

          <h3 style="font-size: 20px; margin-top: 40px; margin-bottom: 16px; color: #1a202c;">How do you plan to use OptiSigns?</h3>

          <div class="use-case-grid">
            <div
              *ngFor="let useCase of useCases"
              class="use-case-card"
              [class.selected]="questionnaireForm.get('primaryUseCase')?.value === useCase.value"
              (click)="questionnaireForm.patchValue({ primaryUseCase: useCase.value })"
            >
              <div class="use-case-icon">{{ useCase.icon }}</div>
              <div class="use-case-label">{{ useCase.label }}</div>
            </div>
          </div>

          <!-- Optional description if "Other" is selected -->
          <div class="form-field" *ngIf="questionnaireForm.get('primaryUseCase')?.value === 'other'" style="margin-top: 24px;">
            <label for="useCaseDescription">Please describe your use case</label>
            <input
              type="text"
              id="useCaseDescription"
              formControlName="useCaseDescription"
              class="form-input"
              placeholder="Tell us more about how you'll use OptiSigns"
            />
          </div>
        </div>

        <!-- Step 4: Technical Proficiency -->
        <div class="step-content" *ngIf="currentStep === 4">
          <h2>What's your technical background?</h2>
          <p class="subtitle">This helps us customize your onboarding experience</p>

          <div class="proficiency-options">
            <div
              *ngFor="let level of proficiencyLevels"
              class="proficiency-option"
              [class.selected]="questionnaireForm.get('technicalProficiency')?.value === level.value"
              (click)="questionnaireForm.patchValue({ technicalProficiency: level.value })"
            >
              <span class="proficiency-icon">{{ level.icon }}</span>
              <div class="proficiency-content">
                <div class="proficiency-title">{{ level.label }}</div>
                <div class="proficiency-description">{{ level.description }}</div>
              </div>
            </div>
          </div>

          <!-- Current Platform (Optional) -->
          <div class="current-platform-section">
            <div class="platform-header">
              <label for="currentPlatform">
                <span class="platform-icon">ðŸ’¼</span>
                Current Platform (Optional)
              </label>
              <span class="optional-badge">Optional</span>
            </div>
            <p class="platform-hint">Tell us about any tools you're currently using for digital signage or presentations</p>
            <textarea
              id="currentPlatform"
              formControlName="currentPlatform"
              class="form-textarea platform-textarea"
              rows="3"
              maxlength="200"
              placeholder="e.g., PowerPoint, Google Slides, Canva, Rise Vision, ScreenCloud, or any other digital signage platform..."
            ></textarea>
            <div class="char-count">
              {{ questionnaireForm.get('currentPlatform')?.value?.length || 0 }} / 200
            </div>
          </div>
        </div>

        <!-- Step 5: Feature Interests -->
        <div class="step-content" *ngIf="currentStep === 5">
          <h2>Which features are most important to you?</h2>
          <p class="subtitle">Select all that apply (optional)</p>

          <div class="feature-grid">
            <div
              *ngFor="let feature of features"
              class="feature-card"
              [class.selected]="isFeatureSelected(feature.value)"
              (click)="toggleFeature(feature.value)"
            >
              <div class="feature-icon">{{ feature.icon }}</div>
              <div class="feature-label">{{ feature.label }}</div>
              <div class="feature-checkmark" *ngIf="isFeatureSelected(feature.value)">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                  <circle cx="10" cy="10" r="10" fill="white"/>
                  <path d="M6 10L9 13L14 7" stroke="#52C67A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
          </div>
        </div>

      </form>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <!-- Navigation Buttons -->
      <div class="button-group">
        <button
          *ngIf="currentStep > 1"
          type="button"
          class="btn btn-back"
          (click)="previousStep()"
        >
          Back
        </button>

        <button
          *ngIf="currentStep < totalSteps"
          type="button"
          class="btn btn-continue"
          [disabled]="!isStepValid()"
          (click)="nextStep()"
        >
          Continue
        </button>

        <button
          *ngIf="currentStep === totalSteps"
          type="button"
          class="btn btn-complete"
          [disabled]="loading"
          (click)="onSubmit()"
        >
          <span *ngIf="!loading">Complete Setup</span>
          <span *ngIf="loading">Completing...</span>
        </button>
      </div>
    </div>

    <!-- Right Side: Illustrations -->
    <div class="content-right">
      <div class="illustration-container">
        <!-- Step 1: Company Info Illustration -->
        <div class="illustration" *ngIf="currentStep === 1">
          <svg viewBox="0 0 400 400" class="company-illustration">
            <circle cx="200" cy="200" r="180" fill="#E8F5EE" opacity="0.5"/>

            <!-- Building/Office -->
            <rect x="120" y="150" width="160" height="170" rx="8" fill="#52C67A"/>
            <rect x="140" y="180" width="30" height="40" fill="white" opacity="0.6"/>
            <rect x="180" y="180" width="30" height="40" fill="white" opacity="0.6"/>
            <rect x="220" y="180" width="30" height="40" fill="white" opacity="0.6"/>
            <rect x="140" y="240" width="30" height="40" fill="white" opacity="0.6"/>
            <rect x="180" y="240" width="30" height="40" fill="white" opacity="0.6"/>
            <rect x="220" y="240" width="30" height="40" fill="white" opacity="0.6"/>
          </svg>
        </div>

        <!-- Step 2: Industry Illustration -->
        <div class="illustration" *ngIf="currentStep === 2">
          <svg viewBox="0 0 400 400" class="buildings-illustration">
            <circle cx="200" cy="200" r="180" fill="#E8F5EE" opacity="0.5"/>
            <circle cx="280" cy="150" r="60" fill="#B8E6CC" opacity="0.3"/>
            <circle cx="120" cy="280" r="80" fill="#B8E6CC" opacity="0.3"/>

            <!-- Buildings -->
            <rect x="120" y="200" width="60" height="120" rx="4" fill="#52C67A"/>
            <rect x="190" y="150" width="80" height="170" rx="4" fill="#45B368"/>
            <rect x="280" y="180" width="70" height="140" rx="4" fill="#6DD68E"/>

            <!-- Windows -->
            <rect x="135" y="220" width="10" height="15" fill="white" opacity="0.6"/>
            <rect x="155" y="220" width="10" height="15" fill="white" opacity="0.6"/>
            <rect x="135" y="250" width="10" height="15" fill="white" opacity="0.6"/>
            <rect x="155" y="250" width="10" height="15" fill="white" opacity="0.6"/>
          </svg>
        </div>

        <!-- Step 3: Screens + Use Case Illustration -->
        <div class="illustration" *ngIf="currentStep === 3">
          <svg viewBox="0 0 400 400" class="monitor-illustration">
            <circle cx="200" cy="200" r="180" fill="#E8F5EE" opacity="0.5"/>
            <circle cx="280" cy="280" r="40" fill="#B8E6CC" opacity="0.4"/>

            <!-- Monitor -->
            <rect x="100" y="140" width="200" height="140" rx="8" fill="#52C67A"/>
            <rect x="110" y="150" width="180" height="110" rx="4" fill="white"/>

            <!-- Chart bars -->
            <rect x="130" y="210" width="20" height="30" fill="#52C67A" opacity="0.7"/>
            <rect x="160" y="190" width="20" height="50" fill="#52C67A"/>
            <rect x="190" y="200" width="20" height="40" fill="#52C67A" opacity="0.7"/>
            <rect x="220" y="180" width="20" height="60" fill="#52C67A"/>
            <rect x="250" y="195" width="20" height="45" fill="#52C67A" opacity="0.7"/>

            <!-- Stand -->
            <rect x="180" y="280" width="40" height="20" fill="#45B368"/>
          </svg>
        </div>

        <!-- Step 4: Technical Level Illustration -->
        <div class="illustration" *ngIf="currentStep === 4">
          <svg viewBox="0 0 400 400" class="technical-illustration">
            <circle cx="200" cy="200" r="180" fill="#E8F5EE" opacity="0.5"/>

            <!-- Laptop -->
            <rect x="100" y="160" width="200" height="120" rx="8" fill="#52C67A"/>
            <rect x="110" y="170" width="180" height="95" rx="4" fill="white"/>

            <!-- Code Lines -->
            <rect x="130" y="190" width="40" height="4" rx="2" fill="#52C67A" opacity="0.5"/>
            <rect x="140" y="200" width="60" height="4" rx="2" fill="#52C67A" opacity="0.7"/>
            <rect x="130" y="210" width="50" height="4" rx="2" fill="#52C67A" opacity="0.6"/>
            <rect x="140" y="220" width="70" height="4" rx="2" fill="#52C67A" opacity="0.8"/>

            <!-- Base -->
            <path d="M80 280 L90 295 L310 295 L320 280 Z" fill="#45B368"/>
          </svg>
        </div>

        <!-- Step 5: Features Illustration -->
        <div class="illustration" *ngIf="currentStep === 5">
          <svg viewBox="0 0 400 400" class="features-illustration">
            <circle cx="200" cy="200" r="180" fill="#E8F5EE" opacity="0.5"/>

            <!-- Grid of feature icons -->
            <rect x="120" y="140" width="60" height="60" rx="8" fill="#52C67A" opacity="0.3"/>
            <rect x="200" y="140" width="60" height="60" rx="8" fill="#52C67A" opacity="0.5"/>
            <rect x="280" y="140" width="60" height="60" rx="8" fill="#52C67A" opacity="0.4"/>
            <rect x="120" y="220" width="60" height="60" rx="8" fill="#52C67A" opacity="0.6"/>
            <rect x="200" y="220" width="60" height="60" rx="8" fill="#52C67A"/>
            <rect x="280" y="220" width="60" height="60" rx="8" fill="#52C67A" opacity="0.4"/>
          </svg>
        </div>
      </div>
    </div>
  </div>
</div>
